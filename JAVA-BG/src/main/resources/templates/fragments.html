<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:fragment="head">
    <title>Medical Center - Modern Healthcare Management</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/css/bootstrap.min.css" rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>
    <link href="/css/custom-style.css" rel="stylesheet" th:href="@{/css/custom-style.css}"/>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<header th:fragment="header">
    <div class="app-header">
        <div class="container">
            <h1>Medical Center</h1>
        </div>
    </div>
</header>

<nav class="navbar navbar-expand-lg navbar-light bg-light" th:fragment="navigation">
    <div class="container">
        <a class="navbar-brand" href="/" th:href="@{/}">
            <span class="brand-icon">ğŸ’Š</span> Medical Center
        </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#navbarNav" aria-controls="navbarNav" 
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/" th:href="@{/}">ğŸ  Home</a>
                    </li>
                    
                    <!-- Dashboard - visible only to medical staff roles -->
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/dashboard" th:href="@{/dashboard}">
                            ğŸ“Š Dashboard
                        </a>
                    </li>
                    
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/medicines" th:href="@{/medicines}">
                            ğŸ’Š Medicines
                        </a>
                    </li>
                    
                    <!-- Show these only for authenticated users -->
                    <li class="nav-item" sec:authorize="hasRole('ADMIN')">
                        <a class="nav-link" href="/medicines/create-medicine" th:href="@{/medicines/create-medicine}">
                            â• Add Medicine
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/doctors" th:href="@{/doctors}">
                            ğŸ‘¨â€âš•ï¸ Doctors
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/recipes" th:href="@{/recipes}">
                            ğŸ“‹ Prescriptions
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/customers" th:href="@{/customers}">
                            ğŸ‘¥ Customers
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/sick-leaves" th:href="@{/sick-leaves}">
                            ğŸ¤’ Sick Leaves
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="hasAnyRole('DOCTOR', 'ADMIN')">
                        <a class="nav-link" href="/reports" th:href="@{/reports}">
                            ğŸ“Š Reports
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="hasRole('CUSTOMER')">
                        <a class="nav-link" href="/my/history" th:href="@{/my/history}">
                            ğŸ“„ My History
                        </a>
                    </li>
                </ul>
                
                <!-- User info and login/logout on the right -->
                <ul class="navbar-nav ms-auto">
                    <!-- User info for authenticated users -->
                    <li class="nav-item" sec:authorize="isAuthenticated()">
                        <span class="nav-link">
                            ğŸ‘¤ <span th:text="${#authentication != null and #authentication.principal instanceof T(org.springframework.security.oauth2.core.user.OAuth2User) ? (#authentication.principal.attributes['name'] != null ? #authentication.principal.attributes['name'] : (#authentication.principal.attributes['preferred_username'] != null ? #authentication.principal.attributes['preferred_username'] : (#authentication.principal.attributes['email'] != null ? #authentication.principal.attributes['email'] : #authentication.name))) : #authentication.name}">User</span>
                        </span>
                    </li>
                    
                    <!-- Logout button for authenticated users -->
                    <li class="nav-item" sec:authorize="isAuthenticated()">
                        <form method="post" action="/logout" th:action="@{/logout}" class="d-inline">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            <button type="submit" class="btn btn-outline-danger">
                                ğŸšª Logout
                            </button>
                        </form>
                    </li>
                    
                    <!-- Login button for anonymous users -->
                    <li class="nav-item" sec:authorize="!isAuthenticated()">
                        <a class="nav-link btn btn-primary text-white px-3" 
                           href="/oauth2/authorization/keycloak">
                            ğŸ” Login
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

<footer th:fragment="footer" class="app-footer">
    <div class="container">
        <div class="text-center">
            <p class="mb-0">Â© 2026 <a href="/">Digital Pharmacy</a> - Modern Healthcare Management System</p>
            <p class="mb-0 mt-2" style="font-size: 0.9rem; opacity: 0.8;">
                Empowering healthcare through technology ğŸ’Š
            </p>
        </div>
    </div>
    <script src="/js/jquery-3.5.1.min.js" th:src="@{/js/jquery-3.5.1.min.js}"></script>
    <script src="/js/bootstrap.bundle.min.js" th:src="@{/js/bootstrap.bundle.min.js}"></script>
</footer>

</html>
